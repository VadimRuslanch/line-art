fragment CartCore on Cart {
    subtotal
    total
    contents {
        itemCount
        nodes {
            key
            quantity
            total
            product {
                node {
                    ...ProductCore
                }
            }
            variation {
                node {
                    id
                    databaseId
                    name
                    sku
                    price
                    attributes {
                        nodes {
                            name
                            value
                        }
                    }
                }
            }
        }
    }
}

query GetCart {
    cart {
        ...CartCore
    }
}

mutation AddToCart($productId: Int!, $quantity: Int!) {
    addToCart(input: { productId: $productId, quantity: $quantity }) {
        cart {
            ...CartCore
        }
    }
}

mutation AddVariableToCart(
    $productId: Int!
    $variationId: Int!
    $quantity: Int! = 1
    $attributes: [ProductAttributeInput!]!
) {
    addToCart(
        input: {
            productId: $productId
            quantity: $quantity
            variationId: $variationId
            variation: $attributes
        }
    ) {
        cart {
            ...CartCore
        }
    }
}

mutation RemoveFromCart($keys: [ID!]!, $all: Boolean) {
    removeItemsFromCart(input: { keys: $keys, all: $all }) {
        cart {
            ...CartCore
        }
    }
}

mutation UpdateCartItemQuantities($items: [CartItemQuantityInput!]!) {
    updateItemQuantities(input: { items: $items }) {
        cart {
            ...CartCore
        }
    }
}
